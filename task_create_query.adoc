---
sidebar: sidebar 
permalink: task_create_query.html 
summary: Les requêtes vous permettent d’identifier rapidement et facilement les actifs et les mesures d’intérêt. 
keywords: query, queries 
---
= Créer des requêtes
:hardbreaks:
:allow-uri-read: 


[role="lead"]
Les requêtes vous permettent de rechercher les actifs de votre locataire à un niveau granulaire, ce qui vous permet de filtrer les données souhaitées et de trier les résultats à votre guise.

Par exemple, vous pouvez créer une requête pour les _volumes_, ajouter un filtre pour rechercher des _stockages_ particuliers associés aux volumes sélectionnés, ajouter un autre filtre pour rechercher une _annotation_ particulière telle que « Niveau 1 » sur les stockages sélectionnés, et enfin ajouter un autre filtre pour rechercher tous les stockages avec _IOPS - Lecture (IO/s)_ supérieur à 25.  Lorsque les résultats sont affichés, vous pouvez ensuite trier les colonnes d’informations associées à la requête par ordre croissant ou décroissant.

Remarque : lorsqu'un nouveau collecteur de données est ajouté et acquiert des ressources, ou que des annotations ou des affectations d'application sont effectuées, vous pouvez interroger ces nouvelles ressources, annotations ou applications uniquement après l'indexation des requêtes.  L'indexation se produit à un intervalle régulier ou lors de certains événements tels que l'exécution de règles d'annotation.

.Créer une requête est très simple :
. Accédez à *Requêtes > *+Nouvelle requête*.
. Dans la liste « Sélectionner... », sélectionnez le type d’objet que vous souhaitez interroger.  Vous pouvez faire défiler la liste ou commencer à taper pour trouver plus rapidement ce que vous recherchez.


.Liste déroulante :
image:QueryDrop-DownList.png["Menu déroulant de requête"]

.Tapez pour rechercher :
image:QueryPageFilter.png["Taper pour trouver"]

Vous pouvez ajouter des filtres pour affiner davantage votre requête en cliquant sur le bouton *+* dans le champ *Filtrer par*.  Regrouper les lignes par objet ou par attribut.  Lorsque vous travaillez avec des données d'intégration (Kubernetes, ONTAP Advanced Metrics, etc.), vous pouvez regrouper par plusieurs attributs, si vous le souhaitez.

image:QueryFilterExample.png["Filtrage et regroupement des requêtes"]

La liste des résultats de la requête affiche un certain nombre de colonnes par défaut, en fonction du type d'objet recherché.  Pour ajouter, supprimer ou modifier les colonnes, cliquez sur l’icône d’engrenage à droite du tableau.  Les colonnes disponibles varient en fonction du type d'actif/métrique.

image:QuerySelectColumns.png["Sélectionner les colonnes"]



== Voyez-le en action

link:https://media.netapp.com/video-detail/d0530e0b-a222-52e7-92b1-dbeeee41b712/explore-and-analyze-with-queries-in-data-infrastructure-insights["Explorer et analyser avec des requêtes dans Data Infrastructure Insights (Vidéo)"]



== Choix de l'agrégation, des unités et de la mise en forme conditionnelle



=== Agrégation et unités

Pour les colonnes « valeur », vous pouvez affiner davantage les résultats de votre requête en choisissant la manière dont les valeurs affichées sont agrégées ainsi qu'en sélectionnant les unités dans lesquelles ces valeurs sont affichées.  Ces options se trouvent en sélectionnant le menu « trois points » dans le coin supérieur d'une colonne.

image:Query_Page_Aggregation_etc.png["Résultats de la page de requête affichant l'agrégation, la mise en forme conditionnelle, l'affichage des unités et le renommage des colonnes"]



==== Unités

Vous pouvez sélectionner les unités dans lesquelles afficher les valeurs.  Par exemple, si la colonne sélectionnée affiche la capacité brute et que les valeurs sont affichées en Gio, mais que vous préférez les afficher en Tio, sélectionnez simplement Tio dans la liste déroulante Affichage de l'unité.



==== Agrégation

De la même manière, si les valeurs affichées sont agrégées à partir des données sous-jacentes sous la forme « Moyenne », mais que vous préférez afficher la somme de toutes les valeurs, sélectionnez « Somme » dans la liste déroulante _Grouper par_ (si vous souhaitez que les valeurs groupées affichent les sommes) ou dans la liste déroulante _Agréger par heure_ (si vous souhaitez que les valeurs de ligne affichent les sommes des données sous-jacentes).

Vous pouvez choisir d'agréger des points de données groupés par _Moyenne, Max, Min ou Somme_.

Vous pouvez regrouper les données de lignes individuelles par _Moyenne, Dernier point de données acquis, Maximum, Minimum ou Somme_.



==== Mise en forme conditionnelle

La mise en forme conditionnelle vous permet de mettre en évidence les seuils de niveau d'avertissement et de niveau critique dans la liste des résultats de la requête, offrant ainsi une visibilité instantanée sur les valeurs aberrantes et les points de données exceptionnels.

image:Query_Page_Conditional_Formatting.png["Mise en forme conditionnelle sur la page de requête"]

La mise en forme conditionnelle est définie séparément pour chaque colonne.  Par exemple, vous pouvez choisir un ensemble de seuils pour une colonne de capacité et un autre ensemble pour une colonne de débit.



==== Renommer la colonne

Renommer une colonne modifie le nom affiché dans la liste des résultats de la requête.  Le nouveau nom de colonne est également affiché dans le fichier résultant si vous exportez la liste de requêtes au format .CSV.



=== Enregistrer

Après avoir configuré votre requête pour afficher les résultats souhaités, vous pouvez cliquer sur le bouton *Enregistrer* pour enregistrer la requête pour une utilisation ultérieure.  Donnez-lui un nom significatif et unique.



== En savoir plus sur le filtrage



=== Caractères génériques et expressions

Lorsque vous filtrez des valeurs de texte ou de liste dans des requêtes ou des widgets de tableau de bord, lorsque vous commencez à saisir, vous avez la possibilité de créer un *filtre générique* basé sur le texte actuel.  La sélection de cette option renverra tous les résultats correspondant à l’expression générique.  Vous pouvez également créer des *expressions* en utilisant NOT ou OR, ou vous pouvez sélectionner l'option « Aucun » pour filtrer les valeurs nulles dans le champ.

image:Type-Ahead-Example-ingest.png["Filtre générique"]

Les filtres basés sur des caractères génériques ou des expressions (par exemple NOT, OR, « Aucun », etc.) s'affichent en bleu foncé dans le champ de filtre.  Les éléments que vous sélectionnez directement dans la liste sont affichés en bleu clair.

image:Type-Ahead-Example-Wildcard-DirectSelect.png["Résultats du filtre générique"]

Notez que le filtrage par caractères génériques et par expressions fonctionne avec du texte ou des listes, mais pas avec des nombres, des dates ou des booléens.



=== Filtres de raffinage

Vous pouvez utiliser les éléments suivants pour affiner votre filtre :

|===


| Filtre | Ce qu'il fait | Exemple | Résultat 


| * (Astérisque) | vous permet de rechercher tout ce que vous voulez | vol*rhel | renvoie toutes les ressources commençant par « vol » et se terminant par « rhel » 


| ? (point d'interrogation) | vous permet de rechercher un nombre spécifique de caractères | BOS-PRD??-S12 | renvoie BOS-PRD**__12__**-S12, BOS-PRD**__23__**-S12, et ainsi de suite 


| OU | vous permet de spécifier plusieurs entités | FAS2240 OU CX600 OU FAS3270 | renvoie l'un des FAS2440, CX600 ou FAS3270 


| PAS | vous permet d'exclure du texte des résultats de recherche | NON EMC* | renvoie tout ce qui ne commence pas par « EMC » 


| _Aucun_ | recherche les valeurs NULL dans tous les champs | _Aucun_ | renvoie les résultats lorsque le champ cible est vide 


| Pas * | recherche les valeurs NULL dans les champs _texte uniquement_ | Pas * | renvoie les résultats lorsque le champ cible est vide 
|===
Si vous placez une chaîne de filtre entre guillemets doubles, Insight traite tout ce qui se trouve entre le premier et le dernier guillemet comme une correspondance exacte.  Tous les caractères spéciaux ou opérateurs à l’intérieur des guillemets seront traités comme des littéraux.  Par exemple, le filtrage par « * » renverra des résultats qui sont un astérisque littéral ; l'astérisque ne sera pas traité comme un caractère générique dans ce cas.  Les opérateurs OR et NOT seront également traités comme des chaînes littérales lorsqu'ils sont placés entre guillemets.



=== Filtrage des valeurs booléennes

Lorsque vous filtrez une valeur booléenne, les choix suivants peuvent vous être proposés pour filtrer :

* *Tout* : cela renverra _tous_ les résultats, y compris les résultats définis sur « Oui », « Non » ou pas définis du tout.
* *Oui* : renvoie uniquement les résultats « Oui ». Notez que DII affiche « Oui » comme coche dans la plupart des tableaux. Les valeurs peuvent être définies sur « Vrai », « Activé », etc. DII traite toutes ces valeurs comme « Oui ».
* *Non* : renvoie uniquement les résultats « Non ». Notez que DII affiche « Non » sous la forme d’un « X » dans la plupart des tableaux. Les valeurs peuvent être définies sur « Faux », « Désactivé », etc. DII traite toutes ces valeurs comme « Non ».
* *Aucun* : renvoie uniquement les résultats pour lesquels la valeur n'a pas été définie du tout. Également appelées valeurs « nulles ».




== Que dois-je faire maintenant que j’ai les résultats de la requête ?

L'interrogation fournit un endroit simple pour ajouter des annotations ou attribuer des applications à des actifs.  Notez que vous ne pouvez attribuer des applications ou des annotations qu'à vos ressources d'inventaire (disque, stockage, etc.).  Les mesures d’intégration ne peuvent pas prendre en charge les annotations ou les affectations d’application.

Pour attribuer une annotation ou une application aux ressources résultant de votre requête, sélectionnez simplement la ou les ressources à l'aide de la colonne de cases à cocher à gauche du tableau des résultats, puis cliquez sur le bouton *Actions en masse* à droite.  Choisissez l’action souhaitée à appliquer aux actifs sélectionnés.

image:QueryVolumeBulkActions.png["Exemple d'actions de requête en masse"]



== Les règles d'annotation nécessitent une requête

Si vous configurezlink:task_create_annotation_rules.html["Règles d'annotation"] , chaque règle doit avoir une requête sous-jacente avec laquelle travailler.  Mais comme vous l'avez vu ci-dessus, les requêtes peuvent être aussi larges ou aussi étroites que vous le souhaitez.
