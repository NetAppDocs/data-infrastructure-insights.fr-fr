---
sidebar: sidebar 
permalink: task_troubleshooting_linux_acquisition_unit_problems.html 
summary: 'Conseils de dépannage pour les problèmes d"unité d"acquisition.' 
keywords: AU, acquisition unit, trioubleshooting 
---
= Dépannage des problèmes d'unité d'acquisition sous Linux
:hardbreaks:
:allow-uri-read: 


[role="lead"]
Vous trouverez ici des suggestions pour résoudre les problèmes liés aux unités d'acquisition sur un serveur Linux.

|===


| *Problème:* | *Essayez ceci :* 


| Le statut AU sur la page *Observabilité > Collecteurs* dans l'onglet *Unités d'acquisition* affiche « Certificat expiré » ou « Certificat révoqué ». | Cliquez sur le menu à droite de l'AU et sélectionnez *Restaurer la connexion*.  Suivez les instructions pour restaurer votre unité d’acquisition : 1.  Arrêtez le service Unité d'acquisition (AU).  Vous pouvez cliquer sur le bouton _Copier la commande d'arrêt_ pour copier rapidement la commande dans le presse-papiers, puis coller cette commande dans une invite de commande sur la machine de l'unité d'acquisition. 2.  Créez un fichier nommé « token » dans le dossier _/var/lib/netapp/cloudinsights/acq/conf_ sur l'AU. 3.  Cliquez sur le bouton _Copier le jeton_ et collez ce jeton dans le fichier que vous avez créé. 4.  Redémarrez le service AU.  Cliquez sur le bouton _Copier la commande de redémarrage_ et collez la commande dans une invite de commande sur l'AU. 


| Autorisation refusée lors du démarrage du service serveur de l'unité d'acquisition | Lorsque l'AU est installé sur SELINUX, SE doit être défini sur le mode _permissif_.  Le mode _Enforcing_ n'est pas pris en charge.  Après avoir défini SELINUX en mode permissif, redémarrez le service AU. 


| Les exigences du serveur ne sont pas satisfaites | Assurez-vous que votre serveur d'unité d'acquisition ou votre machine virtuelle répondlink:concept_acquisition_unit_requirements.html["exigences"] 


| Les exigences du réseau ne sont pas satisfaites | Assurez-vous que votre serveur/VM d'unité d'acquisition peut accéder à votre environnement Data Infrastructure Insights (<environment-name>.c01.cloudinsights.netapp.com) via une connexion SSL sur le port 443.  Essayez les commandes suivantes : _ping <environment-name>.c01.cloudinsights.netapp.com_ _traceroute <environment-name>.c01.cloudinsights.netapp.com_ _curl \https://<environment-name>.c01.cloudinsights.netapp.com_ _wget \https://<environment-name>.c01.cloudinsights.netapp.com_ Notez que le port 443 doit être ouvert « sortant » de l'AU vers Data Infrastructure Insights. 


| Le serveur proxy n'est pas configuré correctement | Vérifiez vos paramètres proxy et désinstallez/réinstallez le logiciel de l'unité d'acquisition si nécessaire pour entrer les paramètres proxy corrects. 1.  Essayez « curl ».  Reportez-vous aux informations/documentations « man curl » concernant les proxys : --preproxy, --proxy-* (il s'agit d'un caractère générique « * » car curl prend en charge de nombreux paramètres de proxy). 2.  Essayez "wget".  Consultez la documentation pour les options proxy. 


| L'installation de l'unité d'acquisition a échoué dans Data Infrastructure Insights avec des erreurs d'informations d'identification lors du démarrage du service d'acquisition (et visible dans le fichier acq.log). | Cela peut être dû à l'inclusion de caractères spéciaux dans les informations d'identification du proxy.  Désinstallez l'AU (_sudo cloudinsights-uninstall.sh_) et réinstallez-le sans utiliser de caractères spéciaux. 


| Linux : bibliothèque manquante / fichier introuvable | Assurez-vous que votre serveur/VM d’unité d’acquisition Linux dispose de toutes les bibliothèques nécessaires.  Par exemple, vous devez avoir la bibliothèque _unzip_ installée sur le serveur.  Pour installer la bibliothèque _unzip_, exécutez la commande _*sudo yum install unzip*_ avant d'exécuter le script d'installation de l'unité d'acquisition 


| Problèmes d'autorisation | Assurez-vous d'être connecté en tant qu'utilisateur avec les autorisations _sudo_ 


| L'acquisition ne fonctionne pas : | Récupérez le fichier acq.log depuis /opt/netapp/cloudinsights/acq/logs (Linux) Redémarrez le service d'acquisition : sudo cloudinsights-service.sh restart acquisition 


| Problèmes de collecte de données : | Envoyez un rapport d'erreur depuis la page de destination du collecteur de données en cliquant sur le bouton « Envoyer un rapport d'erreur » 


| Statut : Échec du battement de cœur | L'unité d'acquisition (AU) envoie un battement de cœur à Data Infrastructure Insights toutes les 60 secondes pour renouveler son bail.  Si l'appel de pulsation échoue en raison d'un problème de réseau ou d'une absence de réponse de Data Infrastructure Insights, la durée de bail de l'AU n'est pas mise à jour.  Lorsque la durée du bail de l'AU expire, Data Infrastructure Insights affiche le statut « Échec du battement de cœur ».  Étapes de dépannage : vérifiez la connexion réseau entre le serveur de l’unité d’acquisition et CloudInsights.  Vérifiez si le service Unité d’acquisition est en cours d’exécution.  Si le service n'est pas en cours d'exécution, démarrez-le.  Consultez le journal de l’unité d’acquisition (/var/log/netapp/cloudinsights/acq/acq.log) pour voir s’il y a des erreurs. 


| Je vois un message « Erreur de pulsation : » | Cette erreur peut se produire en cas d'interruption du réseau entraînant une interruption de la communication entre l'unité d'acquisition et l'environnement Data Infrastructure Insights pendant plus d'une minute.  Vérifiez que la connexion entre l’AU et Data Infrastructure Insights est stable et active. 


| Lors de la réinstallation de l'unité d'acquisition, je vois « ValueError : contexte de fichier pour /opt/netapp/cloudinsights(/.*) ? déjà défini ». | Sur un système avec SELinux, ce message d'erreur peut apparaître après `cloudinsights-uninstall.sh -p` a été exécuté et l'unité d'acquisition doit être réinstallée.  Exécution de la commande `semanage fcontext -d -t usr_t "/opt/netapp/cloudinsights(/.*)?"` devrait corriger le problème et supprimer le message. 
|===


== Considérations sur les proxys et les pare-feu

Si votre organisation nécessite l'utilisation d'un proxy pour l'accès à Internet, vous devrez peut-être comprendre le comportement du proxy de votre organisation et rechercher certaines exceptions pour que Data Infrastructure Insights fonctionne.  Gardez à l’esprit les points suivants :

* Tout d’abord, votre organisation bloque-t-elle l’accès par défaut et autorise-t-elle uniquement l’accès à des sites Web/domaines spécifiques par exception ?  Si tel est le cas, vous devrez ajouter le domaine suivant à la liste des exceptions :
+
 *.cloudinsights.netapp.com
+
Votre unité d'acquisition Data Infrastructure Insights , ainsi que vos interactions dans un navigateur Web avec Data Infrastructure Insights, seront toutes dirigées vers des hôtes portant ce nom de domaine.

* Deuxièmement, certains proxys tentent d’effectuer une inspection TLS/SSL en se faisant passer pour des sites Web Data Infrastructure Insights avec des certificats numériques non générés par NetApp.  Le modèle de sécurité de l’unité d’acquisition Data Infrastructure Insights est fondamentalement incompatible avec ces technologies.  Vous aurez également besoin du nom de domaine ci-dessus, exclu de cette fonctionnalité, pour que l'unité d'acquisition de Data Infrastructure Insights puisse se connecter avec succès à Data Infrastructure Insights et faciliter la découverte de données.


Dans le cas où le proxy est configuré pour l'inspection du trafic, l'environnement Data Infrastructure Insights doit être ajouté à une liste d'exceptions dans la configuration du proxy.  Le format et la configuration de cette liste d'exceptions varient en fonction de votre environnement proxy et de vos outils, mais en général, vous devez ajouter les URL des serveurs Data Infrastructure Insights à cette liste d'exceptions afin de permettre à l'AU de communiquer correctement avec ces serveurs.

La manière la plus simple de procéder consiste à ajouter le domaine Data Infrastructure Insights lui-même à la liste des exceptions :

 *.cloudinsights.netapp.com
Dans le cas où le proxy n'est pas configuré pour l'inspection du trafic, une liste d'exceptions peut être requise ou non.  Si vous ne savez pas si vous devez ajouter Data Infrastructure Insights à une liste d'exceptions, ou si vous rencontrez des difficultés lors de l'installation ou de l'exécution de Data Infrastructure Insights en raison de la configuration du proxy et/ou du pare-feu, contactez votre équipe d'administration de proxy pour configurer la gestion de l'interception SSL par le proxy.



=== Affichage des points de terminaison proxy

Vous pouvez afficher vos points de terminaison proxy en cliquant sur le lien *Paramètres proxy* lors du choix d'un collecteur de données lors de l'intégration, ou sur le lien sous _Paramètres proxy_ sur la page *Aide > Assistance*.  Un tableau comme celui-ci s’affiche.  Si vous disposez de Workload Security dans votre environnement, les URL des points de terminaison configurés seront également affichées dans cette liste.

image:ProxyEndpoints_NewTable.png["Tableau des points de terminaison proxy"]



== Ressources

Des conseils de dépannage supplémentaires peuvent être trouvés dans lelink:https://kb.netapp.com/Cloud/ncds/nds/dii/dii_kbs["Base de connaissances NetApp"] (connexion d'assistance requise).

Des informations d'assistance supplémentaires peuvent être trouvées dans Data Infrastructure Insightslink:concept_requesting_support.html["Support"] page.
